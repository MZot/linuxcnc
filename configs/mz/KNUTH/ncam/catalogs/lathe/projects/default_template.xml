<lcnc-ncam>
  <feature src="lathe/material.cfg" after="" help="&lt;b&gt;Workpiece or raw material used&lt;/b&gt;" old-selected="True" before="" expanded="False" name="Workpiece" new-selected="False" init="" version="1.14" hidden_count="0" definitions="" id="workpiece_001" call="&#10;(begin #sub_name)&#10;(author : Fernand Veilleux)&#10;G7 (Diameter mode)&#10;#&lt;_diameter_mode&gt; = 2 (value is 1 for radius and 2 for diameter)&#10;#&lt;_wp_z&gt; = [#param_z]&#10;#&lt;_wp_dia_od&gt; = [#param_od / 2 * #&lt;_diameter_mode&gt;]&#10;#&lt;_wp_dia_id&gt; = [#param_id / 2 * #&lt;_diameter_mode&gt;]&#10;#&lt;_x_rapid&gt;  = [#&lt;_wp_dia_od&gt; + #param_x_rap * 2]&#10;#&lt;_z_rapid&gt;  = [#&lt;_wp_z&gt; + #param_z_rap]&#10; o&lt;#self_id1&gt; if [#param_sh EQ 1 AND #&lt;_task&gt; EQ 0]&#10;&#9; o&lt;show_stock&gt; CALL [#param_z] [#param_l]&#10; o&lt;#self_id1&gt; endif&#10;    G[#param_cs/10] ;Choose coordinate system, MZ&#10;&#10;(end #sub_name)" path="0" validation="&#10;if self.check_hash('#param_od', 1) &lt;= self.check_hash('#param_id', 1) :&#10;&#9;VALIDATED = False&#10;&#9;self.msg_inv(_('External diameter must be greater than the internal'), 1)" type="workpiece" order="['PARAM_CS', 'PARAM_OD', 'PARAM_ID', 'PARAM_Z', 'PARAM_H2', 'PARAM_X_RAP', 'PARAM_Z_RAP']" icon="l-stock.png">
    <param tool_tip="Choose coordinate system" name="Coordinate System" value="540" call="#param_cs" path="0:0" type="combo" options="G54=540:G55=550:G55=550:G56=560:G57=570:G58=580:G59=590:G59.1=592:G59.2=592" icon="g5x.png"/>
    <param tool_tip="Global variable #_wp_dia_od" name="Ext. diameter" metric_value="50.0" value="2.3622047244" header="h1" call="#param_od" path="0:1" not_allowed="0" icon="e-diam.png" type="float" minimum_value="0.0"/>
    <param tool_tip="Global variable #_wp_dia_id" name="Int. diameter" metric_value="0.0" value="0.0" header="h1" call="#param_id" path="0:2" icon="i-diam.png" type="float" minimum_value="0.0"/>
    <param tool_tip="Global variable #_wp_z" name="Begin position" metric_value="0.0" value="0.0" header="h1" call="#param_z" path="0:3" type="float" icon="z.png"/>
    <param call="#param_h2" hidden="1" type="sub-header" name="Params" path="0:4"/>
    <param tool_tip="Ext. diameter + Safe X" name="Safe X rapid" value="10.0000000000" call="#param_x_rap" path="0:5" not_allowed="0" icon="lathe-rappid-x.png" type="float" minimum_value="0.0"/>
    <param tool_tip="Begin position + Safe Z" name="Safe Z rapid" value="10.0000000000" header="h3" call="#param_z_rap" path="0:6" not_allowed="0" minimum_value="0.0" type="float" icon="lathe-rappid-z.png"/>
    <param name="Work mode" value="7" header="h2" call="#param_wmode" path="0:7" hidden="1" type="combo" options="Diameter=7:Radius=8" icon="circle-rad-dia.png"/>
    <param call="#param_h1" hidden="1" type="sub-header" name="Size and coord" path="0:8"/>
    <param tool_tip="WP lenght from chuck" name="Length" metric_value="250.0" value="10.0" header="h1" call="#param_l" path="0:8:0" not_allowed="0" hidden="1" icon="width.png" type="float" minimum_value="0.0"/>
    <param name="Show limits" value="0" call="#param_sh" path="0:9" hidden="1" type="bool"/>
  </feature>
  <feature src="lathe/tool-change.cfg" after="" help="&lt;b&gt;Change Tool and/or settings&lt;/b&gt;&amp;#10;Changes setting accordingly even if disabled" old-selected="False" before="" expanded="False" name="Tool Change" new-selected="False" init="&#10;a = parent.get_param('param_mode').get_attr('value')&#10;parent.get_param('param_surf_speed').set_grayed(a == '1')&#10;if a == '1' :&#10;&#9;parent.get_param('param_speed').attr['name'] = 'Spindle speed'&#10;else :&#10;&#9;parent.get_param('param_speed').attr['name'] = 'Max spindle'" version="1.14" hidden_count="0" definitions="" id="tool_change_001" call="&#10;(begin #sub_name)&#10;(author : Fernand Veilleux, Mit Zot)&#10;M#param_gear  ;Change gearstage&#10;o&lt;#self_id_act&gt; if [#param_act]&#10;       o&lt;#self_id_tne&gt; if [#param_dnum NE #5400]&#10;       #&lt;_toolchange_pos_x&gt; = [#5181 * 2]&#10;       #&lt;_toolchange_pos_z&gt; = #5183&#10;        M9&#10;        G53 G0 Z[#param_pz]&#10;        G53 G0 X[#param_px]&#10;       o&lt;#self_id_tne&gt; endif&#10;       T#param_dnum M6&#10;       G43&#10;o&lt;#self_id_act&gt; endif&#10;#&lt;_tool_usage&gt;   =  #param_us&#10;#&lt;_spindle_dir&gt;  =  #param_spindle_dir&#10;#&lt;_cooling_mode&gt; =  #param_cooling&#10;#&lt;_rough_feed&gt;   =  #param_r_feed&#10;#&lt;_rough_cut&gt;    =  #param_c_dpt&#10;#&lt;_finish_feed&gt;  =  #param_f_feed&#10;#&lt;_finish_cut&gt;   =  #param_fc_dpt&#10;   M#param_cooling&#10;o&lt;#self_id1&gt; if [#param_mode EQ 0]&#10;&#9;G96 D#param_speed S#param_surf_speed&#10;o&lt;#self_id1&gt; else&#10;&#9;G97 S#param_speed&#10;o&lt;#self_id1&gt; endif&#10;o&lt;#self_id2&gt; if [#&lt;_spindle_dir&gt; GT 0]&#10;&#9;M#&lt;_spindle_dir&gt;&#10;&#9;G4 P#&lt;_spindle_speed_up_delay&gt;&#10;o&lt;#self_id2&gt; endif&#10;#&lt;_z_clear&gt;  = [#5410 + #param_rz]&#10;#&lt;_x_clear&gt;  = [[#5410 + #param_rx] * #&lt;_diameter_mode&gt;]&#10;#&lt;_ix_clear&gt; = [#param_rix * #&lt;_diameter_mode&gt;]&#10;F#&lt;_rough_feed&gt;&#10;(end #sub_name)" path="1" validation="&#10;TOOL_TABLE.save_tool_orient(#param_dnum)" type="tool_change" order="['PARAM_ACT', 'PARAM_DNUM', 'PARAM_US', 'PARAM_TLC', 'PARAM_COOLING', 'PARAM_H2', 'PARAM_GEAR', 'PARAM_SPINDLE_DIR', 'PARAM_MODE', 'PARAM_SPEED', 'PARAM_SURF_SPEED', 'PARAM_H8', 'PARAM_R_FEED', 'PARAM_C_DPT', 'PARAM_H4', 'PARAM_F_FEED', 'PARAM_FC_DPT', 'PARAM_HC', 'PARAM_RX', 'PARAM_RIX', 'PARAM_RZ', 'PARAM_H7', 'PARAM_PX', 'PARAM_PZ', 'PARAM_PZFLOAT']" icon="lathe-tool-change.png">
    <param tool_tip="Params will be set even if disabled" name="Active" value="1" call="#param_act" path="1:0" type="bool" icon="enable.png"/>
    <param tool_tip="Select from tool table" name="Tool number" value="1" call="#param_dnum" path="1:1" type="tool" icon="lathe-tool.png"/>
    <param tool_tip="Select usage for this tool" name="Usage" value="0" header="h1" call="#param_us" path="1:2" hidden="1" type="combo" options="Roughing and finishing=0:Roughing=1:Finishing=2" icon="tool-usage.png"/>
    <param tool_tip="Use G43 and probe if setup" name="Use length comp" value="1" header="h1" call="#param_tlc" path="1:3" hidden="1" type="combo" options="No=0:Already mounted and touched=3:From tool table=1:Table and probe=2" icon="comp-l.png"/>
    <param tool_tip="Use flood, mist or none" name="Use cooling" value="8" call="#param_cooling" path="1:4" type="combo" options="None M9=9:Flood M8=8:Mist M7=7" icon="snowflake.png"/>
    <param call="#param_h2" type="sub-header" name="Spindle control" path="1:5"/>
    <param tool_tip="select gear stage" name="Gear" value="42" call="#param_gear" path="1:6" type="combo" options="1st gear=41:2nd gear=42:3rd gear=43:4th gear=44" icon="lathe-chuck.png"/>
    <param tool_tip="Select spindle rotation" name="Spindle direction" value="3" call="#param_spindle_dir" path="1:7" type="combo" options="M5 Stop=5:M3 CW=3:M4 CCW=4" icon="lathe-dir.png"/>
    <param name="Mode" value="0" call="#param_mode" value_changed="&#10;parent.get_param('param_surf_speed').set_grayed(new_val == '1')&#10;if new_val == '1' :&#10;&#9;parent.get_param('param_speed').attr['name'] = 'Spindle speed'&#10;else :&#10;&#9;parent.get_param('param_speed').attr['name'] = 'Max spindle'" path="1:8" type="combo" options="Constant surface speed=0:RPM=1" icon="lathe-chuck.png"/>
    <param tool_tip="RPM spindle speed" name="Max spindle" value="1000" call="#param_speed" path="1:9" icon="tool-spindle.png" type="int" minimum_value="10"/>
    <param tool_tip="Constant spindle speed" name="Surface speed" type="int" value="150" call="#param_surf_speed" path="1:10" minimum_value="10" grayed="0" icon="tool-spindle.png"/>
    <param tool_tip="Set these when usage is roughing" call="#param_h8" type="sub-header" name="Roughing" path="1:11"/>
    <param tool_tip="Feed at 100% engagement" name="Roughing Feed" value="0.1000000000" call="#param_r_feed" path="1:12" not_allowed="0" icon="lathe-feed.png" type="float" minimum_value="0.0"/>
    <param tool_tip="Depth of cutter engagment in machine units per pass" name="Roughing cut depth" value="2.0000000000" call="#param_c_dpt" path="1:13" not_allowed="0" icon="lathe-depth-step.png" type="float" minimum_value="0.0"/>
    <param tool_tip="Set these when usage include finishing" call="#param_h4" type="sub-header" name="Finishing" path="1:14"/>
    <param tool_tip="Feed at 100% engagement" name="Finishing feed" value="0.0500000000" call="#param_f_feed" path="1:15" not_allowed="0" icon="lathe-feed.png" type="float" minimum_value="0.0"/>
    <param tool_tip="Depth of cutter engagment in machine units per pass" name="Finish cut depth" value="0.5000000000" call="#param_fc_dpt" path="1:16" not_allowed="0" icon="lathe-depth-step.png" type="float" minimum_value="0.0"/>
    <param call="#param_hc" type="sub-header" name="Clearances" path="1:17"/>
    <param tool_tip="Retract distance on multiple passes" name="Retract X" value="2" header="hc" call="#param_rx" not_allowed="0" path="1:17:0" icon="lx-clear.png" type="float" minimum_value="0.0"/>
    <param tool_tip="Internal retract distance" name="Internal retract X" value="0.5" header="hc" call="#param_rix" not_allowed="0" path="1:17:1" icon="ix-clear.png" type="float" minimum_value="0.0"/>
    <param tool_tip="Retract distance on multiple passes" name="Retract Z" value="1" header="hc" call="#param_rz" not_allowed="0" path="1:17:2" icon="lz-clear.png" type="float" minimum_value="0.0"/>
    <param tool_tip="Position for toolchange" call="#param_h7" type="sub-header" name="Position" path="1:18"/>
    <param tool_tip="Abs G53 Position for toolchange" name="Toolchange X" value="#&lt;_toolchange_pos_x&gt;" header="h7" call="#param_px" path="1:18:0" type="gcode"/>
    <param tool_tip="Abs G53 Position for toolchange" name="Toolchange Z" value="#&lt;_toolchange_pos_z&gt;" header="h7" call="#param_pz" path="1:18:1" type="gcode"/>
    <param call="#param_h1" hidden="1" type="sub-header" name="Tool and usage" path="1:19"/>
  </feature>
</lcnc-ncam>
